{"ast":null,"code":"var _s = $RefreshSig$();\n/** @format */\n\nimport { useContext } from \"react\";\nimport axios from \"axios\";\nimport { message } from \"antd\";\nimport { Data } from \"../../App\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useStorage } from \"./useStorage\";\nconst endPoint = \"https://65eb419b43ce164189339311.mockapi.io/users\";\nexport const useUsers = () => {\n  _s();\n  const {\n    setUser,\n    user\n  } = useContext(Data);\n  const {\n    saveToStorage\n  } = useStorage();\n  const navigate = useNavigate();\n  const lookUpUserByUserName = async username => {\n    let lookedUpUser = null;\n    await axios.get(`${endPoint}?username=${username}`).then(res => {\n      const data = res.data;\n      if (data.length > 0) {\n        if (data[0].username === username) {\n          lookedUpUser = data[0];\n        }\n      }\n    }).catch(err => console.log(err));\n    return lookedUpUser;\n  };\n  const onSignup = async (username, email, password) => {\n    const defaultRole = 1; // user\n    const user = {\n      username: username,\n      email: email,\n      password: password,\n      role: defaultRole\n    };\n    const isExisted = await lookUpUserByUserName(username);\n    if (isExisted) {\n      message.error(\"Username này đã tồn tại\");\n    } else {\n      await axios.post(endPoint, user).then(res => {\n        setUser(user);\n        saveToStorage(\"user\", user);\n        message.success(\"Tạo tài khoản thành công\");\n        navigate(\"/\");\n      });\n    }\n  };\n  const onLogOut = () => {\n    message.success(\"Đã đăng xuất khỏi tài khoản\");\n    setUser(null);\n  };\n  const onLogIn = async (username, password) => {\n    const lookedUpUser = await lookUpUserByUserName(username);\n    if (lookedUpUser) {\n      const checkUsername = lookedUpUser.username === username;\n      const checkPassword = lookedUpUser.password === password;\n      if (checkUsername && checkPassword) {\n        setUser(lookedUpUser);\n        message.success(\"Đăng nhập thành công\");\n        navigate(\"/\");\n      } else {\n        message.error(\"Username hoặc password không hợp lệ\");\n      }\n    } else {\n      message.error(\"Username hoặc password không hợp lệ\");\n    }\n  };\n  const getCurrUser = () => {\n    return user;\n  };\n  return {\n    onSignup,\n    getCurrUser,\n    onLogOut,\n    onLogIn\n  };\n};\n_s(useUsers, \"pW9WVFpO9mNq+0mYwdYCQynf2ZA=\", false, function () {\n  return [useStorage, useNavigate];\n});","map":{"version":3,"names":["useContext","axios","message","Data","useNavigate","useStorage","endPoint","useUsers","_s","setUser","user","saveToStorage","navigate","lookUpUserByUserName","username","lookedUpUser","get","then","res","data","length","catch","err","console","log","onSignup","email","password","defaultRole","role","isExisted","error","post","success","onLogOut","onLogIn","checkUsername","checkPassword","getCurrUser"],"sources":["/Users/giakhang/Desktop/STUDY/Kì5/Support HP/Civil-housing-construction-quotation-system/src/Services/Hooks/useUsers.js"],"sourcesContent":["/** @format */\n\nimport { useContext } from \"react\";\nimport axios from \"axios\";\nimport { message } from \"antd\";\nimport { Data } from \"../../App\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useStorage } from \"./useStorage\";\n\nconst endPoint = \"https://65eb419b43ce164189339311.mockapi.io/users\";\n\nexport const useUsers = () => {\n  const { setUser, user } = useContext(Data);\n  const { saveToStorage } = useStorage();\n  const navigate = useNavigate();\n\n  const lookUpUserByUserName = async (username) => {\n    let lookedUpUser = null;\n    await axios\n      .get(`${endPoint}?username=${username}`)\n      .then((res) => {\n        const data = res.data;\n        if (data.length > 0) {\n          if (data[0].username === username) {\n            lookedUpUser = data[0];\n          }\n        }\n      })\n      .catch((err) => console.log(err));\n\n    return lookedUpUser;\n  };\n\n  const onSignup = async (username, email, password) => {\n    const defaultRole = 1; // user\n    const user = {\n      username: username,\n      email: email,\n      password: password,\n      role: defaultRole,\n    };\n\n    const isExisted = await lookUpUserByUserName(username);\n\n    if (isExisted) {\n      message.error(\"Username này đã tồn tại\");\n    } else {\n      await axios.post(endPoint, user).then((res) => {\n        setUser(user);\n        saveToStorage(\"user\", user);\n        message.success(\"Tạo tài khoản thành công\");\n        navigate(\"/\");\n      });\n    }\n  };\n\n  const onLogOut = () => {\n    message.success(\"Đã đăng xuất khỏi tài khoản\");\n    setUser(null);\n  };\n\n  const onLogIn = async (username, password) => {\n    const lookedUpUser = await lookUpUserByUserName(username);\n    if (lookedUpUser) {\n      const checkUsername = lookedUpUser.username === username;\n      const checkPassword = lookedUpUser.password === password;\n\n      if (checkUsername && checkPassword) {\n        setUser(lookedUpUser);\n        message.success(\"Đăng nhập thành công\");\n        navigate(\"/\");\n      } else {\n        message.error(\"Username hoặc password không hợp lệ\");\n      }\n    } else {\n      message.error(\"Username hoặc password không hợp lệ\");\n    }\n  };\n\n  const getCurrUser = () => {\n    return user;\n  };\n\n  return { onSignup, getCurrUser, onLogOut, onLogIn };\n};\n"],"mappings":";AAAA;;AAEA,SAASA,UAAU,QAAQ,OAAO;AAClC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,MAAM;AAC9B,SAASC,IAAI,QAAQ,WAAW;AAChC,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,UAAU,QAAQ,cAAc;AAEzC,MAAMC,QAAQ,GAAG,mDAAmD;AAEpE,OAAO,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAM;IAAEC,OAAO;IAAEC;EAAK,CAAC,GAAGV,UAAU,CAACG,IAAI,CAAC;EAC1C,MAAM;IAAEQ;EAAc,CAAC,GAAGN,UAAU,CAAC,CAAC;EACtC,MAAMO,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAE9B,MAAMS,oBAAoB,GAAG,MAAOC,QAAQ,IAAK;IAC/C,IAAIC,YAAY,GAAG,IAAI;IACvB,MAAMd,KAAK,CACRe,GAAG,CAAE,GAAEV,QAAS,aAAYQ,QAAS,EAAC,CAAC,CACvCG,IAAI,CAAEC,GAAG,IAAK;MACb,MAAMC,IAAI,GAAGD,GAAG,CAACC,IAAI;MACrB,IAAIA,IAAI,CAACC,MAAM,GAAG,CAAC,EAAE;QACnB,IAAID,IAAI,CAAC,CAAC,CAAC,CAACL,QAAQ,KAAKA,QAAQ,EAAE;UACjCC,YAAY,GAAGI,IAAI,CAAC,CAAC,CAAC;QACxB;MACF;IACF,CAAC,CAAC,CACDE,KAAK,CAAEC,GAAG,IAAKC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAAC;IAEnC,OAAOP,YAAY;EACrB,CAAC;EAED,MAAMU,QAAQ,GAAG,MAAAA,CAAOX,QAAQ,EAAEY,KAAK,EAAEC,QAAQ,KAAK;IACpD,MAAMC,WAAW,GAAG,CAAC,CAAC,CAAC;IACvB,MAAMlB,IAAI,GAAG;MACXI,QAAQ,EAAEA,QAAQ;MAClBY,KAAK,EAAEA,KAAK;MACZC,QAAQ,EAAEA,QAAQ;MAClBE,IAAI,EAAED;IACR,CAAC;IAED,MAAME,SAAS,GAAG,MAAMjB,oBAAoB,CAACC,QAAQ,CAAC;IAEtD,IAAIgB,SAAS,EAAE;MACb5B,OAAO,CAAC6B,KAAK,CAAC,yBAAyB,CAAC;IAC1C,CAAC,MAAM;MACL,MAAM9B,KAAK,CAAC+B,IAAI,CAAC1B,QAAQ,EAAEI,IAAI,CAAC,CAACO,IAAI,CAAEC,GAAG,IAAK;QAC7CT,OAAO,CAACC,IAAI,CAAC;QACbC,aAAa,CAAC,MAAM,EAAED,IAAI,CAAC;QAC3BR,OAAO,CAAC+B,OAAO,CAAC,0BAA0B,CAAC;QAC3CrB,QAAQ,CAAC,GAAG,CAAC;MACf,CAAC,CAAC;IACJ;EACF,CAAC;EAED,MAAMsB,QAAQ,GAAGA,CAAA,KAAM;IACrBhC,OAAO,CAAC+B,OAAO,CAAC,6BAA6B,CAAC;IAC9CxB,OAAO,CAAC,IAAI,CAAC;EACf,CAAC;EAED,MAAM0B,OAAO,GAAG,MAAAA,CAAOrB,QAAQ,EAAEa,QAAQ,KAAK;IAC5C,MAAMZ,YAAY,GAAG,MAAMF,oBAAoB,CAACC,QAAQ,CAAC;IACzD,IAAIC,YAAY,EAAE;MAChB,MAAMqB,aAAa,GAAGrB,YAAY,CAACD,QAAQ,KAAKA,QAAQ;MACxD,MAAMuB,aAAa,GAAGtB,YAAY,CAACY,QAAQ,KAAKA,QAAQ;MAExD,IAAIS,aAAa,IAAIC,aAAa,EAAE;QAClC5B,OAAO,CAACM,YAAY,CAAC;QACrBb,OAAO,CAAC+B,OAAO,CAAC,sBAAsB,CAAC;QACvCrB,QAAQ,CAAC,GAAG,CAAC;MACf,CAAC,MAAM;QACLV,OAAO,CAAC6B,KAAK,CAAC,qCAAqC,CAAC;MACtD;IACF,CAAC,MAAM;MACL7B,OAAO,CAAC6B,KAAK,CAAC,qCAAqC,CAAC;IACtD;EACF,CAAC;EAED,MAAMO,WAAW,GAAGA,CAAA,KAAM;IACxB,OAAO5B,IAAI;EACb,CAAC;EAED,OAAO;IAAEe,QAAQ;IAAEa,WAAW;IAAEJ,QAAQ;IAAEC;EAAQ,CAAC;AACrD,CAAC;AAAC3B,EAAA,CAzEWD,QAAQ;EAAA,QAEOF,UAAU,EACnBD,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}